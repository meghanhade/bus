<!-- MUNI nextbus API information:
  
Format:
http://webservices.nextbus.com/service/publicXMLFeed?command=predictions&a=<agency_tag>&stopId=<stop id>&routeTag=<route tag>

agency tag: sf-muni
stop id: (look up here: href="http://transit.511.org/schedules/realtimedepartures.aspx#onlystopid=16038)
routeTitle(string)
stopTitle(string)
<direction> dirTag(string)

9 stopId:16038
9L stopId:16038
27 stopId:13749 -->

<head>
   <title>myMuni</title>
   <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>

<!DOCTYPE html>
<html>
<body>
  <p>
  <script>
function fetchPredictions(url, busLine){
d3.xml(url, function(xml) {
    var minutes =  d3.select(xml).selectAll("prediction")[0].map(function(prediction){
     return d3.select(prediction).attr("minutes");
    });
      if (minutes.length===0){
         d3.select(busLine).text("No busses running")
      }
      else{ 
        d3.select(busLine).text(minutes)}
  });
} 
function refreshPredictions(){
fetchPredictions("http://webservices.nextbus.com/service/publicXMLFeed?command=predictions&a=sf-muni&stopId=16038&routeTag=9", "#nine")
fetchPredictions("http://webservices.nextbus.com/service/publicXMLFeed?command=predictions&a=sf-muni&stopId=16038&routeTag=9L", "#nineL")  
fetchPredictions("http://webservices.nextbus.com/service/publicXMLFeed?command=predictions&a=sf-muni&stopId=13749&routeTag=27", "#twentySeven")}

refreshPredictions()
window.setInterval(refreshPredictions,15000);
  </script>
  </p>
  9:<p id="nine"></p>
  9L:<p id="nineL"></p>
  27:<p id="twentySeven"></p>
</body>
</html>
